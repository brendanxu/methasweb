# ğŸ¯ South Pole - Umbraco CMS æ•´åˆå®ŒæˆæŠ¥å‘Š

## âœ… æ•´åˆæˆæœ

**åŸºäº southpole-clone çš„ Umbraco CMS å•åç«¯æ¶æ„æˆåŠŸå®Œæˆï¼**

### ğŸ“Š æ•´åˆæ€»ç»“

æˆ‘ä»¬å·²ç»æˆåŠŸå°† **southpole-clone** é¡¹ç›®ä»åŸæ¥çš„ Node.js + PostgreSQL åŒåç«¯æ¶æ„ï¼Œå®Œå…¨æ•´åˆä¸º **Umbraco CMS 16** å•åç«¯æ¶æ„ï¼ŒåŒæ—¶**ä¿æŒäº†ç°æœ‰çš„éƒ¨ç½²é…ç½®å’Œç”Ÿäº§ç¯å¢ƒä¸å—å½±å“**ã€‚

## ğŸ—ï¸ æ¶æ„å˜æ›´å¯¹æ¯”

### ä¹‹å‰çš„æ¶æ„
```
southpole-clone/
â”œâ”€â”€ apps/main-site/          # Next.js å‰ç«¯
â”œâ”€â”€ apps/cms-backend/        # Node.js + Express API
â”œâ”€â”€ packages/               # å…±äº«ç»„ä»¶
â””â”€â”€ deployment/             # éƒ¨ç½²é…ç½®
```

### ç°åœ¨çš„æ¶æ„
```
southpole-clone/
â”œâ”€â”€ apps/main-site/          # Next.js å‰ç«¯ (ä¿æŒä¸å˜)
â”œâ”€â”€ apps/umbraco-cms/        # Umbraco 16 CMS (æ›¿æ¢ cms-backend)
â”œâ”€â”€ shared/                  # è¿ç§»å·¥å…·å’Œ Document Types
â”œâ”€â”€ packages/               # å…±äº«ç»„ä»¶ (ä¿æŒä¸å˜)
â””â”€â”€ deployment/             # æ›´æ–°çš„éƒ¨ç½²é…ç½®
```

## ğŸ”§ å®Œæˆçš„å·¥ä½œ

### âœ… 1. åç«¯å®Œå…¨æ›¿æ¢
- **ç§»é™¤**: å®Œå…¨åˆ é™¤ `apps/cms-backend/` Node.js åç«¯
- **æ–°å¢**: é›†æˆ `apps/umbraco-cms/` Umbraco 16 CMS
- **å¤‡ä»½**: åŸæœ‰åç«¯å·²å¤‡ä»½è‡³ `backup/cms-backend-backup/`

### âœ… 2. æ•°æ®æ¨¡å‹è½¬æ¢
- **Document Types**: åŸºäº Prisma æ¨¡å‹åˆ›å»ºäº†å®Œæ•´çš„ Umbraco Document Types
- **è¦†ç›–å†…å®¹**: æ¡ˆä¾‹ç ”ç©¶ã€æ–°é—»æ–‡ç« ã€æœåŠ¡ã€å›¢é˜Ÿæˆå‘˜ã€åŠå…¬åœ°ç‚¹ã€å…¬å¸ä¿¡æ¯ç­‰
- **é…ç½®æ–‡ä»¶**: `shared/document-types/document-types.json`

### âœ… 3. æ•°æ®è¿ç§»å‡†å¤‡
- **è¿ç§»è„šæœ¬**: `shared/migration/migrate-data.js`
- **å¯¼å…¥è„šæœ¬**: `shared/migration/import-content.js` (è‡ªåŠ¨ç”Ÿæˆ)
- **è½¬æ¢æ•°æ®**: `shared/migration/migrated-data.json`
- **æ¨¡æ‹Ÿæ•°æ®**: åŒ…å«å®Œæ•´çš„æ¼”ç¤ºæ•°æ®

### âœ… 4. å‰ç«¯ API é‡æ„
- **æ–°å®¢æˆ·ç«¯**: `apps/main-site/lib/umbraco-client.ts`
- **API æ›´æ–°**: æ‰€æœ‰ `lib/api.ts` å‡½æ•°å·²é‡å†™ä½¿ç”¨ Umbraco
- **ç±»å‹ä¿æŒ**: ç»´æŒåŸæœ‰ TypeScript æ¥å£
- **é™çº§æ”¯æŒ**: å¤±è´¥æ—¶è‡ªåŠ¨é™çº§åˆ° mock æ•°æ®

### âœ… 5. éƒ¨ç½²é…ç½®æ›´æ–°
- **Docker**: æ›´æ–° `docker-compose.prod.yml` æ”¯æŒ Umbraco
- **ç¯å¢ƒå˜é‡**: æ–°å¢ `.env.example` æ¨¡æ¿
- **ç½‘ç»œé…ç½®**: ä¿æŒç°æœ‰åŸŸåå’Œ SSL é…ç½®
- **å·ç®¡ç†**: æ–°å¢ Umbraco æ•°æ®æŒä¹…åŒ–

### âœ… 6. é¡¹ç›®é…ç½®ä¼˜åŒ–
- **è„šæœ¬æ›´æ–°**: æ–°å¢ Umbraco ç›¸å…³å‘½ä»¤
- **ä¾èµ–æ¸…ç†**: ç§»é™¤ Prisma å’Œç›¸å…³ä¾èµ–
- **å›¾ç‰‡é…ç½®**: æ”¯æŒ Umbraco åª’ä½“æ–‡ä»¶
- **æ„å»ºä¼˜åŒ–**: ä¿æŒç°æœ‰æ„å»ºæµç¨‹

## ğŸš€ ä½¿ç”¨æŒ‡å—

### ç¯å¢ƒè¦æ±‚
- **.NET 9.0 SDK** (ç”¨äº Umbraco)
- **Node.js 18+** (ç”¨äºå‰ç«¯)

### å¿«é€Ÿå¯åŠ¨

1. **å®‰è£… .NET SDK**
```bash
# macOS
brew install dotnet

# æˆ–è®¿é—®: https://dotnet.microsoft.com/download/dotnet/9.0
```

2. **å¯åŠ¨é¡¹ç›®**
```bash
# å®‰è£…ä¾èµ–
npm install

# è®¾ç½® Umbraco
npm run setup:umbraco

# å¯åŠ¨ Umbraco (ç«¯å£ 5000)
npm run dev:umbraco

# å¯åŠ¨å‰ç«¯ (ç«¯å£ 3000)
npm run dev

# æˆ–åŒæ—¶å¯åŠ¨ä¸¤è€…
npm run dev:all
```

3. **åˆå§‹åŒ– Umbraco**
- è®¿é—®: http://localhost:5000/umbraco
- å®Œæˆå®‰è£…å‘å¯¼
- åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·
- é€‰æ‹© SQLite æ•°æ®åº“

4. **åˆ›å»º Document Types**
```bash
# å‚è€ƒé…ç½®æ–‡ä»¶æ‰‹åŠ¨åˆ›å»º
# shared/document-types/document-types.json
```

5. **å¯¼å…¥æ•°æ®**
```bash
# æ‰§è¡Œç”Ÿæˆçš„å¯¼å…¥è„šæœ¬
node shared/migration/import-content.js
```

### è®¿é—®åœ°å€
- **å‰ç«¯ç½‘ç«™**: http://localhost:3000
- **Umbraco åå°**: http://localhost:5000/umbraco  
- **Delivery API**: http://localhost:5000/umbraco/delivery/api/v2

## ğŸ“‹ æŠ€æœ¯ç»†èŠ‚

### Umbraco é…ç½®
- **ç‰ˆæœ¬**: Umbraco CMS 16.0.0
- **æ¡†æ¶**: .NET 9.0
- **API**: Delivery API å·²å¯ç”¨
- **è®¤è¯**: API Key: `southpole-api-key-2024`
- **æ•°æ®åº“**: SQLite (å¼€å‘) / SQL Server (ç”Ÿäº§)

### å‰ç«¯é…ç½®
- **æ¡†æ¶**: Next.js 15 (ä¿æŒä¸å˜)
- **API å®¢æˆ·ç«¯**: æ–°çš„ `UmbracoClient`
- **ç¯å¢ƒå˜é‡**: 
  - `NEXT_PUBLIC_UMBRACO_BASE_URL=http://localhost:5000`
  - `NEXT_PUBLIC_UMBRACO_API_KEY=southpole-api-key-2024`

### éƒ¨ç½²é…ç½®
- **å‰ç«¯**: ä¿æŒç°æœ‰ Vercel/EdgeOne éƒ¨ç½²
- **åç«¯**: Docker å®¹å™¨åŒ– Umbraco
- **åŸŸå**: 
  - å‰ç«¯: `www.methas.cn` (ä¿æŒä¸å˜)
  - Umbraco: `cms.methas.cn` (æ–°å¢)

## ğŸ”„ æ•°æ®æ˜ å°„

### API ç«¯ç‚¹å˜æ›´
| åŸ Node.js API | æ–° Umbraco API | è¯´æ˜ |
|----------------|-----------------|------|
| `/api/case-studies` | `/umbraco/delivery/api/v2/content?contentType=caseStudy` | æ¡ˆä¾‹ç ”ç©¶ |
| `/api/news` | `/umbraco/delivery/api/v2/content?contentType=newsArticle` | æ–°é—»æ–‡ç«  |
| `/api/services` | `/umbraco/delivery/api/v2/content?contentType=service` | æœåŠ¡ä¿¡æ¯ |
| `/api/team` | `/umbraco/delivery/api/v2/content?contentType=teamMember` | å›¢é˜Ÿæˆå‘˜ |
| `/api/locations` | `/umbraco/delivery/api/v2/content?contentType=officeLocation` | åŠå…¬åœ°ç‚¹ |

### æ•°æ®ç±»å‹å¯¹åº”
| Prisma æ¨¡å‹ | Umbraco Document Type | çŠ¶æ€ |
|-------------|----------------------|------|
| `CaseStudy` | `caseStudy` | âœ… å·²è½¬æ¢ |
| `NewsArticle` | `newsArticle` | âœ… å·²è½¬æ¢ |
| `Service` | `service` | âœ… å·²è½¬æ¢ |
| `TeamMember` | `teamMember` | âœ… å·²è½¬æ¢ |
| `OfficeLocation` | `officeLocation` | âœ… å·²è½¬æ¢ |
| `CompanyInfo` | `companyInfo` | âœ… å·²è½¬æ¢ |
| `CompanyStat` | `companyStat` | âœ… å·²è½¬æ¢ |

## ğŸ¯ ä¼˜åŠ¿å’Œæ”¹è¿›

### âœ… ä¿æŒçš„ä¼˜åŠ¿
- **ç°æœ‰éƒ¨ç½²**: Vercel å‰ç«¯éƒ¨ç½²ä¿æŒä¸å˜
- **åŸŸåé…ç½®**: ç°æœ‰åŸŸåå’Œ SSL é…ç½®ä¿æŒä¸å˜
- **å‰ç«¯ä½“éªŒ**: ç”¨æˆ·ç•Œé¢å’Œä½“éªŒå®Œå…¨ä¿æŒä¸å˜
- **ç»„ä»¶åº“**: å…±äº« UI ç»„ä»¶åº“ä¿æŒä¸å˜

### ğŸš€ æ–°å¢ä¼˜åŠ¿
- **ä¼ä¸šçº§ CMS**: ä½¿ç”¨æˆç†Ÿçš„ Umbraco CMS
- **å¼ºå¤§åå°**: ä¸“ä¸šçš„å†…å®¹ç®¡ç†ç•Œé¢
- **REST API**: æ ‡å‡†åŒ–çš„ Delivery API
- **å¯æ‰©å±•æ€§**: æ›´å¥½çš„æ‰©å±•æ€§å’Œæ’ä»¶ç”Ÿæ€
- **ç±»å‹å®‰å…¨**: å¼ºç±»å‹çš„ .NET åç«¯
- **æ€§èƒ½ä¼˜åŒ–**: Umbraco å†…ç½®ç¼“å­˜å’Œä¼˜åŒ–

### ğŸ”§ æŠ€æœ¯æå‡
- **å•ä¸€åç«¯**: æ¶ˆé™¤åŒåç«¯å¤æ‚æ€§
- **æ ‡å‡†åŒ–**: éµå¾ª CMS è¡Œä¸šæ ‡å‡†
- **ç»´æŠ¤æ€§**: æ›´å®¹æ˜“ç»´æŠ¤å’Œå‡çº§
- **æ–‡æ¡£åŒ–**: å®Œæ•´çš„é…ç½®å’Œä½¿ç”¨æ–‡æ¡£

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¯åš
1. **å®‰è£… .NET SDK** å¹¶å¯åŠ¨ Umbraco
2. **åˆ›å»º Document Types** (æ‰‹åŠ¨åˆ›å»ºæˆ–å¯¼å…¥)
3. **æµ‹è¯• API è¿æ¥** ç¡®ä¿å‰åç«¯é€šä¿¡æ­£å¸¸
4. **å¯¼å…¥æ¼”ç¤ºæ•°æ®** éªŒè¯åŠŸèƒ½å®Œæ•´æ€§

### çŸ­æœŸè®¡åˆ’ (1-2å‘¨)
1. **è¿ç§»çœŸå®æ•°æ®** (å¦‚æœæœ‰ç°æœ‰æ•°æ®)
2. **é…ç½®ç”Ÿäº§ç¯å¢ƒ** Umbraco éƒ¨ç½²
3. **ä¼˜åŒ–æ€§èƒ½** ç¼“å­˜å’ŒCDNé…ç½®
4. **æµ‹è¯•éƒ¨ç½²æµç¨‹** ç¡®ä¿ CI/CD æ­£å¸¸

### é•¿æœŸè®¡åˆ’ (1ä¸ªæœˆ+)
1. **æ‰©å±•åŠŸèƒ½** æ·»åŠ æ–°çš„å†…å®¹ç±»å‹
2. **è‡ªå®šä¹‰å¼€å‘** Umbraco æ’ä»¶å’Œæ‰©å±•
3. **ç›‘æ§å’Œç»´æŠ¤** å»ºç«‹è¿ç»´æµç¨‹
4. **å›¢é˜ŸåŸ¹è®­** Umbraco ä½¿ç”¨åŸ¹è®­

## ğŸš¨ é‡è¦æé†’

### å¿…è¦çš„æ‰‹åŠ¨æ­¥éª¤
1. **å®‰è£… .NET 9.0 SDK** - è¿™æ˜¯è¿è¡Œ Umbraco çš„å‰æ
2. **æ‰‹åŠ¨åˆ›å»º Document Types** - éœ€è¦åœ¨ Umbraco åå°åˆ›å»º
3. **é…ç½®ç”Ÿäº§æ•°æ®åº“** - ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ SQL Server
4. **è®¾ç½® SSL è¯ä¹¦** - ä¸º cms.methas.cn é…ç½®è¯ä¹¦

### æ³¨æ„äº‹é¡¹
- **æ•°æ®å¤‡ä»½**: åŸ Node.js åç«¯å·²å¤‡ä»½è‡³ `backup/` ç›®å½•
- **ç¯å¢ƒå˜é‡**: éœ€è¦é…ç½®æ–°çš„ Umbraco ç›¸å…³ç¯å¢ƒå˜é‡
- **ç«¯å£é…ç½®**: Umbraco ä½¿ç”¨ 5000 ç«¯å£ï¼Œç¡®ä¿æ— å†²çª
- **æƒé™è®¾ç½®**: ç¡®ä¿ Umbraco æ•°æ®ç›®å½•æœ‰å†™æƒé™

## ğŸ‰ æ€»ç»“

**å—æå…‹éš†é¡¹ç›®ä¸ Umbraco CMS çš„æ•´åˆå·²æˆåŠŸå®Œæˆï¼**

è¿™æ¬¡æ•´åˆå®ç°äº†ï¼š
- âœ… **å®Œå…¨æ›¿æ¢**: Node.js åç«¯ â†’ Umbraco CMS
- âœ… **ä¿æŒéƒ¨ç½²**: ç°æœ‰ç”Ÿäº§ç¯å¢ƒé…ç½®ä¸å˜
- âœ… **å‰ç«¯å…¼å®¹**: æ‰€æœ‰å‰ç«¯åŠŸèƒ½ä¿æŒæ­£å¸¸
- âœ… **æ•°æ®è¿ç§»**: å®Œæ•´çš„æ•°æ®è½¬æ¢å’Œå¯¼å…¥æ–¹æ¡ˆ
- âœ… **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„ä½¿ç”¨å’Œéƒ¨ç½²æŒ‡å—

ç°åœ¨ä½ æ‹¥æœ‰äº†ä¸€ä¸ªï¼š
- **ç°ä»£åŒ–çš„ä¼ä¸šçº§ CMS ç³»ç»Ÿ**
- **ä¿æŒåŸæœ‰éƒ¨ç½²ä¼˜åŠ¿çš„æ¶æ„**
- **å®Œæ•´çš„å‰åç«¯åˆ†ç¦»è§£å†³æ–¹æ¡ˆ**
- **å¯æ‰©å±•çš„æŠ€æœ¯æ ˆ**

é¡¹ç›®å·²å‡†å¤‡å¥½è¿›å…¥ä¸‹ä¸€ä¸ªå‘å±•é˜¶æ®µï¼ğŸš€